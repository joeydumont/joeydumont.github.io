---
layout: post
title: Corrrupted SVN repo and the solution
date: '2012-02-02T18:01:00.001-05:00'
author: jayd
tags:
- command-line
- sourceforge
- svn
modified_time: '2012-02-02T18:01:54.490-05:00'
blogger_id: tag:blogger.com,1999:blog-3428773921792525741.post-5586533657766183760
blogger_orig_url: http://blog.joey-dumont.ca/2012/02/currently-taking-numerical-physics.html
---

<div dir="ltr" style="text-align: left;" trbidi="on"><div style="text-align: justify;"><span style="font-family: 'Helvetica Neue', Arial, Helvetica, sans-serif;">&nbsp; &nbsp;I'm currently taking a Numerical Physics course at U. Laval. So far, it has been a really enjoyable experience. However, I would like to share some technical know-how I acquired while working on one of the projects.</span></div><div style="text-align: justify;"><span style="font-family: 'Helvetica Neue', Arial, Helvetica, sans-serif;">&nbsp; &nbsp;We are mostly using MATLAB (I personally use <a href="http://www.gnu.org/software/octave/" target="_blank">Octave</a>, which is the open-source counterpart) to do the projects. As of the fourth project, I am working with a partner, which immediately lead to the classic problem: how do we share the code?</span></div><div style="text-align: justify;"><span style="font-family: 'Helvetica Neue', Arial, Helvetica, sans-serif;">&nbsp; &nbsp; Of course, this problem has been solved in thousands of ways. I chose to create an account on SourceForge (I don't have my own server, so it was the easiest way) and start a project where I could dump the all the code in an SVN repository. (By the way, all the code we write, for what it's worth, is Creative Commons.)</span></div><div style="text-align: justify;"><span style="font-family: 'Helvetica Neue', Arial, Helvetica, sans-serif;">&nbsp; &nbsp;Everything went well; up till yesterday. For some obscure reason, when I tried to svn up&nbsp;<a href="http://www.noagendashow.com/" target="_blank">in the morning</a>, svn returned the error&nbsp;</span></div><blockquote class="tr_bq"><div style="text-align: justify;"><span style="font-family: 'Helvetica Neue', Arial, Helvetica, sans-serif;">Reading one svndiff window read beyond the end of the representation.</span></div></blockquote><div style="text-align: justify;"><span style="font-family: 'Helvetica Neue', Arial, Helvetica, sans-serif;">which I didn't know about. Some Googling informed me that the repository was corrupted. &nbsp;Some more Googling revealed a SourceForge <a href="https://sourceforge.net/apps/trac/sourceforge/wiki/SVN%20adminrepo" target="_blank">support page</a> that gave a solution to the problem.</span></div><div style="text-align: justify;"><span style="font-family: 'Helvetica Neue', Arial, Helvetica, sans-serif;">&nbsp; &nbsp;Okay, so here's the complete solution. You <a href="https://sourceforge.net/apps/trac/sourceforge/wiki/Shell%20service" target="_blank">log on</a> to the Shell SourceForge provide and run the following commands:</span></div><blockquote class="tr_bq"><br /><div style="text-align: justify;"><span style="font-family: 'Helvetica Neue', Arial, Helvetica, sans-serif;">adminrepo --checkout svn</span></div><div style="text-align: justify;"><span style="font-family: 'Helvetica Neue', Arial, Helvetica, sans-serif;">svnadmin dump -r 0:92 /svnroot/<b>projectName</b>/ &gt; ~/repo.dump</span></div></blockquote><div style="text-align: justify;"><span style="font-family: 'Helvetica Neue', Arial, Helvetica, sans-serif;">The adminrepo checks out the SVN repo of your project in a folder that you can modify. You then dump the repo (I used -r 0:92 because I knew the repo was sane at rev 92 and because I had manually merged the diffs of -r 93:95 in my working directory).</span></div><div style="text-align: justify;"><span style="font-family: 'Helvetica Neue', Arial, Helvetica, sans-serif;">&nbsp; &nbsp;Now, if you're sure you have a good backup, you can delete the repo. We will then create a new one and load the dump file into this new repo.</span></div><blockquote class="tr_bq"><br /><div style="text-align: justify;"><span style="font-family: 'Helvetica Neue', Arial, Helvetica, sans-serif;">rm -rf /svnroot/<b>projectName</b>/</span></div><div style="text-align: justify;"><span style="font-family: 'Helvetica Neue', Arial, Helvetica, sans-serif;">svnadmin create /svnroot/<b>projectName</b></span></div><div style="text-align: justify;"><span style="font-family: 'Helvetica Neue', Arial, Helvetica, sans-serif;">adminrepo --save svn</span></div></blockquote><div style="text-align: justify;"><span style="font-family: 'Helvetica Neue', Arial, Helvetica, sans-serif;">Now half the fun is done. The repo is back in the main folder (which you can't modify directly) and your DB should be un-corrupted (or whatever).</span></div><div style="text-align: justify;"><span style="font-family: 'Helvetica Neue', Arial, Helvetica, sans-serif;">&nbsp; &nbsp;If you're using the new SourceForge bashboard, you can't stop here. You have to tell the dashboard that you've made some drastic changes to the repo. In the SourceForge web interface, navigate to Admin â†’ Tools. Under the SVN tool, click on Import Repo. Enter the following URL:</span></div><blockquote class="tr_bq" style="text-align: justify;"><span style="font-family: 'Helvetica Neue', Arial, Helvetica, sans-serif;">https://projectName.svn.sourceforge.net/svnroot/<b>projectName</b></span></blockquote><div style="text-align: justify;"><span style="font-family: 'Helvetica Neue', Arial, Helvetica, sans-serif;"><br /></span></div><div style="text-align: justify;"><span style="font-family: 'Helvetica Neue', Arial, Helvetica, sans-serif;">click Import and you're done!&nbsp;</span></div><div style="text-align: justify;"><span style="font-family: 'Helvetica Neue', Arial, Helvetica, sans-serif;"><br /></span></div><div style="text-align: justify;"><span style="font-family: 'Helvetica Neue', Arial, Helvetica, sans-serif;">Please inform me in the comments is something is unclear or just plain wrong. Thanks!</span></div></div>